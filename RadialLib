local TweenService = game:GetService("TweenService")
local CoreGui = game:GetService("CoreGui")
local Players = game:GetService("Players")

local RadialLib = {}
RadialLib.__index = RadialLib

function RadialLib.new(titleText)
    local self = setmetatable({}, RadialLib)
    
    -- UI Principal
    self.Gui = Instance.new("ScreenGui")
    self.Gui.Name = "DeltaExactRadial_V2"
    self.Gui.Parent = CoreGui
    self.Gui.ZIndexBehavior = Enum.ZIndexBehavior.Sibling

    -- Botão Abrir/Fechar (Canto Superior)
    self.MenuButton = Instance.new("TextButton")
    self.MenuButton.Size = UDim2.new(0, 45, 0, 45)
    self.MenuButton.Position = UDim2.new(0, 10, 0, 10)
    self.MenuButton.BackgroundColor3 = Color3.fromRGB(20, 20, 20)
    self.MenuButton.BorderSizePixel = 0
    self.MenuButton.Text = "M"
    self.MenuButton.TextColor3 = Color3.new(1, 1, 1)
    self.MenuButton.Font = Enum.Font.GothamBold
    self.MenuButton.Parent = self.Gui
    Instance.new("UICorner", self.MenuButton).CornerRadius = UDim.new(0, 8)

    -- Container da Roda (Onde ocorre a animação de escala)
    self.MainContainer = Instance.new("Frame")
    self.MainContainer.AnchorPoint = Vector2.new(0.5, 0.5)
    self.MainContainer.Position = UDim2.new(0.5, 0, 0.5, 0)
    self.MainContainer.Size = UDim2.new(0, 0, 0, 0) -- Começa em 0
    self.MainContainer.BackgroundTransparency = 1
    self.MainContainer.Visible = false
    self.MainContainer.Parent = self.Gui

    -- Imagem da Roda (Fiel à imagem com fatias)
    self.WheelBackground = Instance.new("ImageLabel")
    self.WheelBackground.Size = UDim2.new(1, 0, 1, 0)
    self.WheelBackground.BackgroundTransparency = 1
    self.WheelBackground.Image = "rbxassetid://6071575216" -- Linhas divisórias originais
    self.WheelBackground.ImageColor3 = Color3.fromRGB(30, 30, 30)
    self.WheelBackground.ImageTransparency = 0.3
    self.WheelBackground.Parent = self.MainContainer

    -- Círculo Central Escuro
    self.CenterCircle = Instance.new("Frame")
    self.CenterCircle.AnchorPoint = Vector2.new(0.5, 0.5)
    self.CenterCircle.Position = UDim2.new(0.5, 0, 0.5, 0)
    self.CenterCircle.Size = UDim2.new(0.4, 0, 0.4, 0)
    self.CenterCircle.BackgroundColor3 = Color3.fromRGB(15, 15, 15)
    self.CenterCircle.ZIndex = 10
    self.CenterCircle.Parent = self.MainContainer
    Instance.new("UICorner", self.CenterCircle).CornerRadius = UDim.new(1, 0)

    self.TitleLabel = Instance.new("TextLabel")
    self.TitleLabel.Size = UDim2.new(0.8, 0, 0.8, 0)
    self.TitleLabel.Position = UDim2.new(0.1, 0, 0.1, 0)
    self.TitleLabel.BackgroundTransparency = 1
    self.TitleLabel.Text = titleText or "Selecione um emote"
    self.TitleLabel.TextColor3 = Color3.new(1, 1, 1)
    self.TitleLabel.Font = Enum.Font.SourceSans
    self.TitleLabel.TextSize = 22
    self.TitleLabel.TextWrapped = true
    self.TitleLabel.ZIndex = 11
    self.TitleLabel.Parent = self.CenterCircle

    -- Variáveis de Controle
    self.Items = {}
    self.CurrentPage = 1
    self.IsOpen = false
    self.IsAnimating = false

    self.MenuButton.MouseButton1Click:Connect(function() self:Toggle() end)

    return self
end

function RadialLib:Toggle()
    if self.IsAnimating then return end
    self.IsAnimating = true
    
    self.IsOpen = not self.IsOpen
    
    if self.IsOpen then
        self.MainContainer.Visible = true
        local tween = TweenService:Create(self.MainContainer, TweenInfo.new(0.4, Enum.EasingStyle.Back), {Size = UDim2.new(0, 450, 0, 450)})
        tween:Play()
        tween.Completed:Wait()
    else
        local tween = TweenService:Create(self.MainContainer, TweenInfo.new(0.3, Enum.EasingStyle.Quad, Enum.EasingDirection.In), {Size = UDim2.new(0, 0, 0, 0)})
        tween:Play()
        tween.Completed:Wait()
        if not self.IsOpen then self.MainContainer.Visible = false end
    end
    
    self.IsAnimating = false
end

function RadialLib:AddButton(name, icon, isToggle, callback)
    table.insert(self.Items, {
        Name = name,
        Icon = icon or "",
        IsToggle = isToggle,
        Callback = callback,
        State = false
    })
    self:Render()
end

function RadialLib:Render()
    -- Limpar elementos de página antigos
    for _, obj in pairs(self.MainContainer:GetChildren()) do
        if obj.Name == "ItemBtn" or obj.Name == "NavArrow" then obj:Destroy() end
    end

    local start = (self.CurrentPage - 1) * 8 + 1
    
    -- Setas de Navegação (Aparecem se tiver > 8 itens)
    if #self.Items > 8 then
        self:CreateArrow("Next", 1)
        self:CreateArrow("Prev", -1)
    end

    -- Criar os 8 slots
    for i = 0, 7 do
        local data = self.Items[start + i]
        if not data then break end

        local angle = (i * 45) - 90
        local rad = math.rad(angle)
        
        local btn = Instance.new("ImageButton")
        btn.Name = "ItemBtn"
        btn.Size = UDim2.new(0, 85, 0, 85)
        btn.AnchorPoint = Vector2.new(0.5, 0.5)
        btn.Position = UDim2.new(0.5 + math.cos(rad) * 0.35, 0, 0.5 + math.sin(rad) * 0.35, 0)
        btn.BackgroundTransparency = 1
        btn.Image = data.Icon
        btn.Parent = self.MainContainer

        local label = Instance.new("TextLabel")
        label.Size = UDim2.new(1, 0, 0, 20)
        label.Position = UDim2.new(0, 0, 0.75, 0)
        label.BackgroundTransparency = 1
        label.Text = data.Name
        label.TextColor3 = data.State and Color3.fromRGB(0, 255, 127) or Color3.new(1, 1, 1)
        label.Font = Enum.Font.SourceSansBold
        label.TextSize = 18
        label.Parent = btn

        btn.MouseButton1Click:Connect(function()
            if data.IsToggle then
                data.State = not data.State
                label.TextColor3 = data.State and Color3.fromRGB(0, 255, 127) or Color3.new(1, 1, 1)
            end
            data.Callback(data.State)
        end)
    end
end

function RadialLib:CreateArrow(type, val)
    local arrow = Instance.new("TextButton")
    arrow.Name = "NavArrow"
    arrow.Size = UDim2.new(0, 45, 0, 45)
    arrow.AnchorPoint = Vector2.new(0.5, 0.5)
    arrow.Position = (type == "Next") and UDim2.new(0.92, 0, 0.5, 0) or UDim2.new(0.08, 0, 0.5, 0)
    arrow.BackgroundColor3 = Color3.fromRGB(30, 30, 30)
    arrow.Text = (type == "Next") and ">" or "<"
    arrow.TextColor3 = Color3.new(1, 1, 1)
    arrow.Font = Enum.Font.GothamBold
    arrow.Parent = self.MainContainer
    Instance.new("UICorner", arrow).CornerRadius = UDim.new(1, 0)

    arrow.MouseButton1Click:Connect(function()
        if self.IsAnimating then return end
        self.IsAnimating = true

        -- Animação de Giro Rápido
        local targetRot = (type == "Next") and 360 or -360
        local spin = TweenService:Create(self.WheelBackground, TweenInfo.new(0.5, Enum.EasingStyle.Quart, Enum.EasingDirection.InOut), {Rotation = self.WheelBackground.Rotation + targetRot})
        
        spin:Play()
        task.wait(0.2) -- Troca o conteúdo no meio do giro
        
        self.CurrentPage = self.CurrentPage + val
        if self.CurrentPage < 1 then self.CurrentPage = 1 end
        if self.CurrentPage > math.ceil(#self.Items / 8) then self.CurrentPage = 1 end
        
        self:Render()
        task.wait(0.3)
        self.IsAnimating = false
    end)
end

return RadialLib

-- update.com
